\documentclass[specialist, substylefile = spbu.rtx,
subf,href,colorlinks=true, 12pt]{disser}

% \usepackage[a4paper, mag=1000, includefoot,
%     left=2cm, right=1.5cm, top=2cm, bottom=2cm, headsep=1cm, footskip=1cm]{geometry}

\usepackage[a4paper, top=2cm, bottom=2cm, left=3cm, right=1.5cm, headsep=1cm, footskip=1cm]{geometry}

\usepackage[T1,T2A]{fontenc}
\setcounter{tocdepth}{2}

\usepackage{graphicx}
\graphicspath{ {images/} }
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm} %for \newtheorem*
\usepackage{bm}
\usepackage[english,russian]{babel}
\usepackage{import}
\usepackage{pgfplots}
\pgfplotsset{compat=1.9}

\usepackage{multirow}
\newtheorem{theorem}{Теорерма}
\newtheorem{corollary}[theorem]{Следствие}
\newtheorem{lemma}[theorem]{Лемма}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{definition}[theorem]{Определение}
\newtheorem{claim}[theorem]{Утверждение}
\newtheorem{fact}[theorem]{Факт}
\newtheorem{assumption}[theorem]{Предположение}

\newtheorem{alg}{Алгоритм}
\newtheorem{zam}{Замечание}
\newtheorem{example}{Пример}[section]

\newenvironment{Proof}{\par\noindent{\bf Доказательство.}}{\hfill$\scriptstyle\blacksquare$}
\newenvironment{ex}{\par\noindent{\bf Пример.}}{}
\newenvironment{pr1}{\par\noindent{\bf Дано:}}{}
\newenvironment{pr2}{\par\noindent{\bf Шаги:}}{}
\newenvironment{pr3}{\par\noindent{\bf Результат:}}{}


\DeclareMathOperator{\F}{\mathsf{F}}

\begin{document}
	
	%\input{bachelor.tex}
	\pagebreak
	%\tableofcontents
	%\pagebreak
	
	%\maketitle
	%\maketitle[en]
	
	%\pagebreak
	%\tableofcontents
	\pagebreak
	
	\section*{Текст выступления <<Замена непрерывного распределения на дискретное для применения на практике>>.}
	\section*{Слайд №2}
	
	В практических задачах нередко требуется заменить непрерывное распределение на
	дискретное с сохранением математического ожидания и дисперсии. Одним из методов
	нахождения такого распределения для аппроксимации нормального распределения является метод Свонсона. Однако в ряде областей, например, в нефтяной промышленности распределением, описывающим запасы нефти, общепринятым является логнормальное распределение. Аппроксимация по методу Свонсона для нормального распределения используется в этих областях, хотя распределение и логнормальное. Также аппроксимируемые случайные величины складывают и умножают.Соответственно, реальной задачей является аппроксимация суммы и произведения логнормальных случайных величин по аппроксимациям исходных случайных величин.

	\section*{Слайд №3}
	
	План работы состоит в следующем.
	\begin{enumerate}
		\item Рассмотреть общий подход к трехточечной аппроксимации,трехточечную аппроксимацию нормального распределения, метод Свонсона и вывод правила 30-40-30.
		\item Рассмотреть трехточечную аппроксимацию логнормального распределения и её свойства.
		\item Построить алгоритм аппроксимации произведения двух логнормальных распределений.
		\item Построить алгоритм аппроксимации суммы двух логнормальных распределений.
	\end{enumerate}
	
	\section*{Слайд №4}
Часто бывает на практике, что вместо настоящего распределения известны три его квантили, стандартно это 10-, 50- и 90-процентили. Задачей является нахождение по ним математического ожидания и дисперсии. Обычно задача решается построением весов для квантилей так, чтобы у полученного дискретного распределения были такие же математическое ожидание и дисперсия, как у исходного. Пусть дана непрерывная случайная величина $\xi$ с функцией распределения $\F(x)$. Обозначим $m = \mathbf E(\xi)$, $s^{2} = \mathbf D(\xi)$.
Для неё заданы квантили $x_{\pi_{1}}$, $x_{\pi_{2}}$, $x_{\pi_{3}}$. Также есть случайная дискретная величина $\tilde{\xi}$, которая задана следующим образом.
Для неё тоже делаем обозначения математического ожидания и дисперсии.
Задача: аппроксимировать распределение случайной величины $\xi$ дискретным распределением $\tilde{\xi}$, то есть найти $p_{1}$, $p_{2}$, $p_{3}$ такие, что следующие равенства верные.

\section*{Слайд №5}
Рассмотрим предложение. Пусть верна следующая система, где $\hat{x}_{\pi_{i}} = \hat{\F}^{-1}(\pi_{i})$, $\hat{\F}(y)$ "--- функция распределения $\displaystyle{\hat{\xi} = \frac{\xi-m}{s}}$. Тогда $m=\tilde{m}$ и $s^{2} = \tilde{s}^{2}$. Это Предложение дает требуемую аппроксимацию дискретным распределением, если найденные вероятности $p_{i}$ являются неотрицательными. Рассмотрим частный случай $\xi\sim N(\mu, \sigma), \pi = 0.1$, получаем $p_{1}\approx 0.305$, $p_{2}\approx 0.390$,  $p_{3}\approx 0.305$. Эти вероятности примерно равны 0.3, 0.4, 0.3, поэтому это правило называют правилом 30-40-30.

\section*{Слайд №6}

Пусть $\xi = \ln(\eta)$ и $\xi \sim N(\mu, \sigma)$. Знаем, как выразить параметры логнормального распределения через параметры нормального. По следующим формулам. Обратная функция распределения $\eta$ имеет следующий вид. Также мною было доказано это предложение. Зная любые два квантиля, можно через них выразить параметры $\mu$ и $\sigma$.

\section*{Слайд №7}

Имеем следующий алгоритм аппроксимации логнормального распределения. Дано: квантили $x_{\pi_{1}}, x_{\pi_{2}}, x_{\pi_{3}}$ логнормальной случайной величины $\eta$, $\ln(\eta) \sim N(\mu, \sigma)$.
\begin{enumerate}
	\item Выражаем параметры $\mu$ и $\sigma$ математическое ожидание и дисперсию соответствующего нормального распределения через известные $x_{\pi_{1}}, x_{\pi_{2}}, x_{\pi_{3}}$. 
	\item Вычисляем значения математического ожидания $m$ и дисперсии $s^{2}$ случайной величины $\eta$, используя $\mu$ и $\sigma$.
	\item С помощью системы уравнений находим значения весов $p_{1}$, $p_{2}$, $p_{3}$, используя вычисленные $m$ и $s^{2}$.
\end{enumerate}
Результат: веса $p_{1}$, $p_{2}$, $p_{3}$ для $x_{\pi_{1}}, x_{\pi_{2}}, x_{\pi_{3}}$ случайной величины $\tilde{\xi}$. В реальных задачах в нефтяной промышленности используются следующие диапазоны параметров:
$\mu\leq12$, $\sigma\leq1.5$. Поэтому мы будем обращать на них особое внимание.

\section*{Слайд №8}
	Мы рассмотрели способы вычисления весов для квантилей при аппроксимации логнормального распределения. Но найденные веса являются вероятностями не при любом $\sigma$. Выясним, какое должно быть ограничение на этот параметр. Мною было доказано следующее предложение, а также следствие из него. Таким образом, мы получили условие для существования дискретной вероятностной аппроксимации. Например, для $\pi=0.1$ получаем ограничение $\sigma\leq 0.6913$, $\sigma^{2}\leq 0.4779$.
	
\section*{Слайд №9}

Возникает проблема: метод Свонсона выведенный для аппроксимации нормального распределения используют для логнормального. Какова точность аппроксимации $m$ и $s^{2}$? Мною доказано предложение, формула для вычисления относительной ошибки аппроксимации математического ожидания представлена на слайде, результат не зависит от параметра $\mu$.

\section*{Слайд №10}
Также мною была доказана формула для вычисления ошибки аппроксимации дисперсии, она представлена на слайде, результат не зависит от параметра $\mu$.

\section*{Слайд №11}

	Построим график зависимости относительной ошибки аппроксимации математического ожидания и дисперсии  от $\sigma$. Видим, что при $\sigma\leq1.5$, взятых из нашего диапазона, ошибка аппроксимации математического ожидания меньше $12\%$, а ошибка аппроксимации дисперсии может достигать $80\%$. Для $\sigma\geq 0.69$, когда условие для существования аппроксимации не выполнено, ошибка математического ожидания может быть как маленькой, так и очень большой. Ошибка дисперсии при этом точно больше $25\%$.

\section*{Слайд №12}

Мною было подробно написано обоснование алгоритма для нахождения трехточечной симметричной аппроксимации произведения логнормальных распределений. Верно следующее предложение. Зная квантили случайной величины $\xi_{1}$ и квантили случайной величины $\xi_{2}$, можно найти квантили соответствующие квантили случайной величины $\xi_{1}\xi_{2}$ по следующим формулам, представленным на экране. Здесь $a$ и $b$ такие, что прямая $y=\dfrac{x-a}{b}$, проходит через точки $(\ln(x_{\pi}y_{\pi}), t)$ и $(\ln(x_{0.5}y_{0.5}),0)$. Значение $t$ выражается через известные квантили следующим образом.

\section*{Слайд №13}

Рассмотрим сумму двух логнормальных случайных величин $\xi = \xi_{1}+\xi_{2}$. Поставим задачу аппроксимации суммы логнормальным распределением $\ln(\eta)\sim N(\mu, \sigma)$, так как нужно рассматривать сумму не обязательно двух, а произвольного числа случайных величин. То есть нужно найти квантили $z_{\pi}$, $z_{0.5}$, $z_{1-\pi}$ случайной величины $\eta$.

\section*{Слайд №14}

Имеем следующий алгоритм для решения задачи. Дано: квантили $x_{\pi}$, $x_{0.5}$, $x_{1-\pi}$ "--- квантили $\xi_{1}$, $y_{\pi}$, $y_{0.5}$, $y_{1-\pi}$ "--- квантили $\xi_{2}$.

	\begin{enumerate}
		\item По набору квантилей $\xi_{1}$ находим параметры $\mu_{1}$, $\sigma_{1}$ нормального распределения.
		\item По набору квантилей $\xi_{2}$ находим параметры $\mu_{2}$, $\sigma_{2}$ нормального распределения.
		\item Находим математические ожидания и дисперсии $\xi_{1}$ и $\xi_{2}.$
		\item Вычисляем математическое ожидание $\xi_{1}+\xi_{2}.$
		\item Вычисляем дисперсию $\xi_{1}+\xi_{2}.$
		\item Находим параметры нормального распределения.
		\item Находим значения квантилей через $\mu$ и $\sigma$.
		\item Находим значения вероятностей $p_{1}$, $p_{2}$, $p_{3}$.
	\end{enumerate}
	
Результат: вероятности $p_{1}$, $p_{2}$, $p_{3}$ для квантилей $z_{\pi_{1}}, z_{\pi_{2}}, z_{\pi_{3}}$ случайной величины $\eta$, которая является дискретной аппроксимацией аппроксимации суммы логнормальным распределением.

\section*{Слайд №15}

Выразим ошибки аппроксимации квантилей $q_{\pi}$, $q_{0.5}$, $q_{1-\pi}$ случайной величины $\xi$ через параметры $\mu_{1}$, $\mu_{2}$, $\sigma_{1}^{2}$, $\sigma_{2}^{2}$. Здесь значения $z_{\pi}$, $z_{0.5}$, $z_{1-\pi}$ вычисляются через обратную функцию распределения для $\eta$. Параметры $\mu$, $\sigma$ можно найти через параметры случайных величин $\xi_{1}$, $\xi_{2}$ и вычисленные значения
$m = \exp\left( \mu_{1}+\frac{\sigma_{1}^{2}}{2}\right) + \exp\left( \mu_{2}+\frac{\sigma_{2} ^{2}}{2}\right)$, $s^{2} = m_{1}^{2}(\exp(\sigma_{1}^{2})-1)+m_{2}^{2}(\exp(\sigma_{2}^{2})-1)$. Квантили $\eta$ выражаются через функцию распределения $\xi = \xi_{1}+\xi_{2}$, найденную с помощью формулы свертки.

\section*{Слайд №16}	

Рассмотрим $\ln(\xi_{1}) \sim N(4, \sigma _{1}^{2})$, $\ln(\xi_{2}) \sim N(4, \sigma _{2}^{2})$ и найдем ошибки в зависимости от $\sigma_{1}^{2}$ (строка) и $\sigma_{2}^{2}$ (столбец) с помощью моделирования, объемы выборок равны $10^{6}$. Ошибки представлены в этих двух таблицах. Также вычислим для данных значений $\sigma_{1}$ и $\sigma_{2}$ коэффициенты асимметрии и коэффициент эксцесса. Они представлены на следующей таблице.

\section*{Слайд №17}
Построим оценки плотности для $\xi$ и $\eta$ при $\mu_{1} = \mu_{2} = 4$ и вычислим ошибки аппроксимации. Для $\sigma_{1}^{2} = 0.25$, $\sigma_{2}^{2} = 0.25$ получили $err_{med} = 0.12\%$,  $err_{q_{10}} = 0.45\%$,  $err_{q_{90}} = 0.28\%$.

\section*{Слайд №18}

Теперь посмотрим на случай, когда ошибки аппроксимации достаточно большие. Для $\sigma_{1}^{2} = 2.25$, $\sigma_{2}^{2} = 0.25$ получили $err_{med} = 20.9\%$,  $err_{q_{10}} = 66.7\%$,  $err_{q_{90}} = 19.1\%$.

\section*{Слайд №19}
Таким образом, мною были получены следующие результаты. 
\begin{enumerate}
	\item Получено условие на $\sigma$ для существования трехточечной симметричной вероятностной аппроксимации логнормального распределения.
	\item Численно оценена точность аппроксимации математического ожидания и дисперсии логнормального распределения с помощью метода Свонсона, применяемого к нормальному распределению.
	\item Формально и полно написано обоснование алгоритма для нахождения трехточечной симметричной аппроксимации произведения логнормальных распределений.
	\item Построен алгоритм для нахождения трехточечной симметричной аппроксимации суммы логнормальных распределений.
	\item Численно оценена точность трехточечной симметричной аппроксимации суммы логнормальных распределений.
\end{enumerate}
	
\end{document}